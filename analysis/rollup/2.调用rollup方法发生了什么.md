## 调用 rollup 发生了什么

在源码的 src/rollup/rollup.ts 文件中找到 rollup 的定义：

```js
export default function rollup(rawInputOptions: RollupOptions): Promise<RollupBuild> {
  return rollupInternal(rawInputOptions, null);
}
```

rollup 方法就是将用户传入的 rawInputOptions 原封不动的传给了 rollupInternal 方法，并且多了一个参数 null。

- rawInputOptions 就是用户传入的参数对象，它遵守 RollupOptions 接口,RollupOptions 继承自 InputOptions

```js
export interface InputOptions {
  acorn?: Record<string, unknown>; //对象类型。acorn是一个js语法解析器，非必传。代表用户可以使用自定义的语法解析器，如果不传则默认使用acorn解析器
  acornInjectPlugins?: (() => unknown)[] | (() => unknown); //InjectPlugins
  cache?: false | RollupCache; //缓存
  context?: string; //context
  experimentalCacheExpiry?: number; //graph.pluginCache ,默认 最大值为10。这个是实验性质的功能
  external?: ExternalOption; //自定义判断是否为外部模块的函数，非必传
  /** @deprecated Use the "inlineDynamicImports" output option instead. */
  inlineDynamicImports?: boolean;
  input?: InputOption; //打包入口模块，可以是 string | string[] | { [entryAlias: string]: string } 这几种类型
  makeAbsoluteExternalsRelative?: boolean | 'ifRelativeSource';
  /** @deprecated Use the "manualChunks" output option instead. */
  manualChunks?: ManualChunksOption; //代码块
  maxParallelFileOps?: number; //最大队列执行数，默认为20
  /** @deprecated Use the "maxParallelFileOps" option instead. */
  maxParallelFileReads?: number;
  moduleContext?: ((id: string) => string | NullValue) | { [id: string]: string }; //模块id默认是undefined
  onwarn?: WarningHandlerWithDefault; //告警函数
  perf?: boolean; //显示性能计时
  plugins?: InputPluginOption; //自定义插件
  preserveEntrySignatures?: PreserveEntrySignaturesOption; //如果值为false则不保留exports代码，默认值为"exports-only"
  /** @deprecated Use the "preserveModules" output option instead. */
  preserveModules?: boolean; //保留模块，默认值undefined
  preserveSymlinks?: boolean; //默认值false
  shimMissingExports?: boolean; //默认值false
  strictDeprecations?: boolean; //默认值false
  treeshake?: boolean | TreeshakingPreset | TreeshakingOptions; //treeshake 配置
  watch?: WatcherOptions | false;
}
```
